---
galaxy_info:
  role_name: manual_cluster_vault
  namespace: mdd13
  author: Ivan Medaev
  company: Kitezh
  min_ansible_version: "2.11"
  description: |
    Install and configure HashiCorp Vault as a cluster using manual binary installation.
    Supports Raft and Consul storage backends, HTTP/HTTPS modes, and Transit auto-unseal.

  # Supported platforms:
  platforms:
    - name: Ubuntu
      versions:
        - focal       # 20.04
        - jammy       # 22.04
        - noble       # 24.04
    - name: Debian
      versions:
        - bullseye    # 11
        - bookworm    # 12
        - trixie      # 13
    - name: EL
      versions:
        - "8"         # RHEL 8 / CentOS 8
        - "9"         # RHEL 9 / CentOS 9
        - "10"        # RHEL 10
    - name: OpenSUSE Leap
      versions:
        - "15.6"      # Leap 15.6
        - "16.0"      # Leap 16.0
    - name: SLES
      versions:
        - "15.6"      # SLES 15.6
        - "16.0"      # SLES 16.0

  # Tags for Ansible Galaxy search:
  galaxy_tags:
    - vault
    - hashicorp
    - security
    - secrets
    - cluster

  # Issue tracker and repository:
  issue_tracker_url: https://github.com/exitfound/vip/issues
  repository: https://github.com/exitfound/vip

# Dependent roles will be executed before manual-cluster-vault:
dependencies:
  - role: system-prepare

# Defines required global variables with validation:
argument_specs:
  main:
    options:
      global_vault_current_version:
        type: str
        required: true
        description: Vault version to install (e.g., "1.21.1")

      global_vault_file_archive_checksum:
        type: str
        required: true
        description: SHA256 checksum for Vault archive (e.g., "sha256:abc123...")

      global_vault_host_listening_address:
        type: str
        required: true
        description: Address Vault listens on (e.g., "0.0.0.0")

      global_vault_host_listening_port:
        type: int
        required: true
        description: Port Vault listens on (e.g., 8200)

      global_vault_lease_default_value:
        type: str
        required: true
        description: Default lease TTL for secrets (e.g., "24h")

      global_vault_lease_max_value:
        type: str
        required: true
        description: Maximum lease TTL for secrets (e.g., "768h")

      global_vault_cluster_enable_https:
        type: bool
        required: false
        default: false
        description: Enable HTTPS for Vault cluster communication

      global_vault_cluster_enable_raft:
        type: bool
        required: false
        default: true
        description: Enable Raft as storage backend

      global_vault_cluster_enable_consul:
        type: bool
        required: false
        default: false
        description: Enable Consul as storage backend

      global_vault_cluster_enable_transit:
        type: bool
        required: false
        default: false
        description: Enable Transit auto-unseal
